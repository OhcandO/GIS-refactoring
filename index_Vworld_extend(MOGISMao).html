<!-- WMTS 바로 요청 -->

<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <title>브이월드 오픈API</title>
    <title>2DMap</title>
    <link rel="stylesheet" href="./lib/openlayers_v7.5.1/ol.css">
    <link rel="stylesheet" href="./lib/spin.js/spin.css">
    <script type="module">

    import { SourceFactory } from "./MO_GIS/classes/MO.SourceFactory.js";
    import { LayerFactory } from "./MO_GIS/classes/MO.LayerFactory.js";
    import { StyleFactory } from "./MO_GIS/classes/MO.StyleFactory.js";
    import {MOGISMap} from './MO_GIS/classes/MO.MOGISMap.js';
        //DB에서 관리
        const baseLayerCode = 
        [
            {
                sourceType: "wmts", category: "vworld", srid: "EPSG:3857", origin: "https://api.vworld.kr",
                sourcePathname: "/req/wmts/1.0.0/{key}/{layer}/{tileMatrix}/{tileRow}/{tileCol}.{tileType}",
                id: 1, layerTitle: "vworld_base", typeName: "Base", boolIsdefault: "Y",
                apiKey: "B58E48FE-683E-3E7E-B91C-2F912512FE60", 
            },
            {
                sourceType: "wmts", category: "vworld", srid: "EPSG:3857", origin: "https://api.vworld.kr",
                sourcePathname: "/req/wmts/1.0.0/{key}/{layer}/{tileMatrix}/{tileRow}/{tileCol}.{tileType}",
                id: 2, layerTitle: "vworld_Satellite", typeName: "Satellite", boolIsdefault: "N",
                apiKey: "B58E48FE-683E-3E7E-B91C-2F912512FE60",
            },
            {
                sourceType: "wmts", category: "vworld", srid: "EPSG:3857", origin: "https://api.vworld.kr",
                sourcePathname: "/req/wmts/1.0.0/{key}/{layer}/{tileMatrix}/{tileRow}/{tileCol}.{tileType}",
                id: 3, layerTitle: "vworld_gray", typeName: "gray", boolIsdefault: "N",
                apiKey: "B58E48FE-683E-3E7E-B91C-2F912512FE60",
            },
            {
                sourceType: "wmts", category: "vworld", srid: "EPSG:3857", origin: "https://api.vworld.kr",
                sourcePathname: "/req/wmts/1.0.0/{key}/{layer}/{tileMatrix}/{tileRow}/{tileCol}.{tileType}",
                id: 4, layerTitle: "vworld_midnight", typeName: "midnight", boolIsdefault: "N",
                apiKey: "B58E48FE-683E-3E7E-B91C-2F912512FE60",
            },
            {
                sourceType: "wmts", category: "vworld", srid: "EPSG:3857", origin: "https://api.vworld.kr",
                sourcePathname: "/req/wmts/1.0.0/{key}/{layer}/{tileMatrix}/{tileRow}/{tileCol}.{tileType}",
                id: 5, layerTitle: "vworld_Hybrid", typeName: "Hybrid", boolIsdefault: "N",
                apiKey: "B58E48FE-683E-3E7E-B91C-2F912512FE60",
            }
        ]
        ;

        const default_spec = {
            /** Map 이 생성될 기본 DIV id */
            target: 'mainMap',
            projection: `EPSG:3857`,
            center: [128.463659, 36.647830],  //예천소방서 [경도,위도] [y,x] [latitude, longitude]
        };

        let mainMap = new MOGISMap(default_spec);
        const srcFactory = new SourceFactory();
        const layerFactory = new LayerFactory();
        const styleFactory = new StyleFactory();
        mainMap.setFactory(srcFactory);
        mainMap.setFactory(layerFactory);
        mainMap.setFactory(styleFactory);

        mainMap.setBaseLayerCodeArr(baseLayerCode);

        //기본 지도 생성
        mainMap.setBaseLayer();

        //----SPINNER

        // let op = {
        //     lines: 15, length: 38, width: 12, radius: 38,
        //     scale: 1, corners: 1, speed: 1, rotate: 0,
        //     animation: "spinner-line-fade-more",
        //     direction: "1", color: "#ffffff",
        //     fadeColor: "transparent",
        //     top: "50%", left: "50%", shadow: "grey 3px 4px 8px 1px",
        //     zIndex: 2000000000,
        //     className: "spinner", position: "absolute",
        // };
        //
        //let spin = new Spinner(op).spin(document.querySelector('#mainMap'))
        //globalThis.spin = spin;


        globalThis.mainMap = mainMap;


    </script>
    <style>
        .olControlAttribution {
            right: 20px;
        }

        .olControlLayerSwitcher {
            right: 20px;
            top: 20px;
        }

        #map {
            position: relative;
            height: 600px;
            border: 1px solid brown;
        }
        #spin {
            height: 100px;
            width: 50%;
            border: 1px solid blue;
        }
    </style>
</head>

<body>
    <div id="map"></div>
</body>

</html>